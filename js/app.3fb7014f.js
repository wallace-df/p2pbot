(function(e){function t(t){for(var n,o,i=t[0],l=t[1],d=t[2],u=0,b=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&b.push(r[o][0]),r[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);c&&c(t);while(b.length)b.shift()();return a.push.apply(a,d||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],n=!0,i=1;i<s.length;i++){var l=s[i];0!==r[l]&&(n=!1)}n&&(a.splice(t--,1),e=o(o.s=s[0]))}return e}var n={},r={app:0},a=[];function o(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=n,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(s,n,function(t){return e[t]}.bind(null,n));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var c=l;a.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},"17c5":function(e){e.exports=JSON.parse('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"orderId","type":"string"},{"indexed":false,"internalType":"address","name":"tokenContractAddress","type":"address"},{"indexed":false,"internalType":"address","name":"buyerAddress","type":"address"},{"indexed":false,"internalType":"bytes32","name":"buyerHash","type":"bytes32"},{"indexed":false,"internalType":"address","name":"sellerAddress","type":"address"},{"indexed":false,"internalType":"bytes32","name":"sellerHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"fee","type":"uint256"}],"name":"OrderLocked","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"orderId","type":"string"},{"indexed":false,"internalType":"address","name":"tokenContractAddress","type":"address"},{"indexed":false,"internalType":"address","name":"sellerAddress","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"fee","type":"uint256"},{"indexed":false,"internalType":"bool","name":"adminAction","type":"bool"}],"name":"OrderRefunded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"orderId","type":"string"},{"indexed":false,"internalType":"address","name":"tokenContractAddress","type":"address"},{"indexed":false,"internalType":"address","name":"buyerAddress","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"bool","name":"adminAction","type":"bool"}],"name":"OrderReleased","type":"event"},{"inputs":[{"internalType":"string","name":"_orderId","type":"string"}],"name":"adminRefundSeller","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_orderId","type":"string"}],"name":"adminReleaseToBuyer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_orderId","type":"string"},{"internalType":"address","name":"_tokenContractAddress","type":"address"},{"internalType":"address","name":"_buyerAddress","type":"address"},{"internalType":"bytes32","name":"_buyerHash","type":"bytes32"},{"internalType":"bytes32","name":"_sellerHash","type":"bytes32"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"uint256","name":"_fee","type":"uint256"}],"name":"escrowERC20","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_orderId","type":"string"},{"internalType":"address","name":"_buyerAddress","type":"address"},{"internalType":"bytes32","name":"_buyerHash","type":"bytes32"},{"internalType":"bytes32","name":"_sellerHash","type":"bytes32"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"uint256","name":"_fee","type":"uint256"}],"name":"escrowRBTC","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"_tokenContractAddress","type":"address"}],"name":"fees","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_tokenContractAddress","type":"address"}],"name":"isERC20Whitelisted","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_orderId","type":"string"}],"name":"orderById","outputs":[{"components":[{"internalType":"string","name":"id","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"address","name":"tokenContractAddress","type":"address"},{"internalType":"address","name":"buyerAddress","type":"address"},{"internalType":"bytes32","name":"buyerHash","type":"bytes32"},{"internalType":"address","name":"sellerAddress","type":"address"},{"internalType":"bytes32","name":"sellerHash","type":"bytes32"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"fee","type":"uint256"},{"internalType":"enum RSKEscrow.EscrowStatus","name":"status","type":"uint8"},{"internalType":"bool","name":"adminAction","type":"bool"}],"internalType":"struct RSKEscrow.EscrowOrder","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_orderId","type":"string"},{"internalType":"bytes32","name":"_sellerCode","type":"bytes32"}],"name":"refundSeller","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_orderId","type":"string"},{"internalType":"bytes32","name":"_buyerCode","type":"bytes32"}],"name":"releaseToBuyer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_tokenContractAddress","type":"address"},{"internalType":"bool","name":"flag","type":"bool"}],"name":"setWhitelistedERC20Token","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_userAddress","type":"address"}],"name":"userOrders","outputs":[{"components":[{"internalType":"string","name":"id","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"address","name":"tokenContractAddress","type":"address"},{"internalType":"address","name":"buyerAddress","type":"address"},{"internalType":"bytes32","name":"buyerHash","type":"bytes32"},{"internalType":"address","name":"sellerAddress","type":"address"},{"internalType":"bytes32","name":"sellerHash","type":"bytes32"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"fee","type":"uint256"},{"internalType":"enum RSKEscrow.EscrowStatus","name":"status","type":"uint8"},{"internalType":"bool","name":"adminAction","type":"bool"}],"internalType":"struct RSKEscrow.EscrowOrder[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_tokenContractAddress","type":"address"}],"name":"withdrawFees","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,s){"use strict";s.r(t);var n=s("7a23"),r=s("6605"),a=s("5502");const o={key:0,style:{"text-align":"right"}},i={class:"badge bg-dark m-3 fs-5"};function l(e,t,s,r,a,l){const d=Object(n["w"])("router-view");return Object(n["r"])(),Object(n["e"])("div",null,[this.activeConnection?(Object(n["r"])(),Object(n["e"])("div",o,[Object(n["f"])("h2",i,Object(n["y"])(l.activeConnection.networkName)+" - "+Object(n["y"])(e.formatAddress(l.activeConnection.walletAddress)),1)])):Object(n["d"])("",!0),Object(n["h"])(d)])}var d=s("100f"),c=s.n(d),u=s("2eaf"),b=s("31af"),m=s.n(b),y=s("9721"),f=s("8f0a"),p=s("07b1"),h=s("eb2c"),O=s("c0d8"),j=s.n(O);const g={development:"https://public-node.testnet.rsk.co",test:"https://public-node.testnet.rsk.co",production:"https://public-node.rsk.co"};var w={nodeURLs:g,networkNames:{development:"RSK Testnet",test:"RSK Testnet",production:"RSK Mainnet"},wallets:{rpcUrls:{development:{31:g["development"]},test:{31:g["test"]},production:{30:g["production"]}},portisOptions:{development:{id:"a1c8672b-7b1c-476b-b3d0-41c27d575920",network:{nodeUrl:g["development"],chainId:31}},test:{id:"a1c8672b-7b1c-476b-b3d0-41c27d575920",network:{nodeUrl:g["test"],chainId:31}},production:{id:"a1c8672b-7b1c-476b-b3d0-41c27d575920",network:{nodeUrl:g["production"],chainId:30}}}},rskEscrowABI:s("17c5"),erc20ABI:s("a840"),contractAddresses:{development:"0xe2514B40ccf6De1Adc9FA25219bC4F17C5cac948",test:"0xe2514B40ccf6De1Adc9FA25219bC4F17C5cac948",production:"0x3465f85d57C4189D1e6f3580a078B9f8F7672aee"},tokens:{development:{RBTC:{id:"RBTC",symbol:"tRBTC",address:"0x0000000000000000000000000000000000000000",decimals:18},RIF:{id:"RIF",symbol:"tRIF",address:"0x19f64674d8a5b4e652319f5e239efd3bc969a1fe",decimals:18,image:"https://s2.coinmarketcap.com/static/img/coins/64x64/3701.png"},DOC:{id:"DOC",symbol:"DoC",address:"0xcb46c0ddc60d18efeb0e586c17af6ea36452dae0",decimals:18,image:"https://static.moneyonchain.com/moc-alphatestnet/public/moc/icon-stable.svg"}},test:{RBTC:{id:"RBTC",symbol:"tRBTC",address:"0x0000000000000000000000000000000000000000",decimals:18},RIF:{id:"RIF",symbol:"tRIF",address:"0x19f64674d8a5b4e652319f5e239efd3bc969a1fe",decimals:18,image:"https://s2.coinmarketcap.com/static/img/coins/64x64/3701.png"},DOC:{id:"DOC",symbol:"DoC",address:"0xcb46c0ddc60d18efeb0e586c17af6ea36452dae0",decimals:18,image:"https://static.moneyonchain.com/moc-alphatestnet/public/moc/icon-stable.svg"}},production:{RBTC:{id:"RBTC",symbol:"RBTC",address:"0x0000000000000000000000000000000000000000",decimals:18},RIF:{id:"RIF",symbol:"RIF",address:"0x2acc95758f8b5f583470ba265eb685a8f45fc9d5",decimals:18,image:"https://s2.coinmarketcap.com/static/img/coins/64x64/3701.png"},DOC:{id:"DOC",symbol:"DoC",address:"0xe700691da7b9851f2f35f8b8182c69c53ccad9db",decimals:18,image:"https://static.moneyonchain.com/moc-alphatestnet/public/moc/icon-stable.svg"}}}};const A="production",k=w.wallets.rpcUrls[A],v=Object.keys(k).map(Number),T=new c.a({cacheProvider:!1,providerOptions:{walletconnect:{package:u["a"],options:{bridge:"https://walletconnect-bridge.rifos.org/",rpc:k}},portis:{package:m.a,options:w.wallets.portisOptions[A]},torus:{package:y["a"]},"custom-ledger":p["ledgerProviderOptions"],"custom-dcent":h["dcentProviderOptions"],"custom-trezor":{...f["trezorProviderOptions"],options:{manifestEmail:"info@iovlabs.org",manifestAppUrl:"https://basic-sample.rlogin.identity.rifos.org/"}}},rpcUrls:k,supportedChains:v}),C=w.contractAddresses[A],x=w.networkNames[A];let I=null,S=null;var B={setConnectionListener(e){S=e},async getInstance(){if(I)return I;let e=await T.connect(),t=e.provider,s=new j.a(t),n=(await s.eth.getAccounts())[0];return I={walletAddress:n,web3Instance:s,networkName:x,contract:new s.eth.Contract(w.rskEscrowABI,C),provider:t},t.on("chainChanged",(function(e){v.indexOf(Number(e))<0&&location.reload()})),t.on("chainChanged",(function(e){v.indexOf(Number(e))<0&&location.reload()})),t.on("disconnect",(function(){location.reload()})),S&&S({networkName:I.networkName,walletAddress:I.walletAddress}),t.on("accountsChanged",(function(e){e&&0!==e.length?(I.walletAddress=e[0],S&&S({networkName:I.networkName,walletAddress:I.walletAddress})):location.reload()})),I}},R={name:"App",components:{},created(){let e=this;B.setConnectionListener((function(t){t&&e.$store.commit("setActiveConnection",t)}))},data(){return{}},computed:{activeConnection(){return this.$store.state.activeConnection}},methods:{}},E=s("6b0d"),_=s.n(E);const $=_()(R,[["render",l]]);var L=$;const P={loading:!1,activeSection:"",activeConnection:null},N={setLoading(e,t){e.loading=t},setActiveSection(e,t){e.activeSection=t},setActiveConnection(e,t){e.activeConnection=t}},F={},D={};var M={state:P,getters:F,mutations:N,actions:D};const H={key:0,class:"loading_container"},U=Object(n["f"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["f"])("span",{class:"sr-only"})],-1),q=[U],V={key:1,class:"loading_container"},K={class:"text-danger"},Y={key:2},J={class:"p-5"},W=Object(n["f"])("h2",{class:"text-success text-center mb-4"},[Object(n["g"])("Your locked funds "),Object(n["f"])("i",{class:"text-secondary"},"(seller)")],-1),z={key:0,class:"text-center"},G=Object(n["f"])("i",{class:"text-primary"},"(You have no locked funds)",-1),Q=[G],X=Object(n["f"])("th",null,"Order ID",-1),Z=Object(n["f"])("th",null,"Timestamp",-1),ee=Object(n["f"])("th",null,"Seller address",-1),te=Object(n["f"])("th",null,"Buyer address",-1),se=Object(n["f"])("th",null,"Order Amount",-1),ne=Object(n["f"])("th",null,"Fee",-1),re=Object(n["f"])("th",null,"Total",-1),ae={class:"mt-2"},oe=Object(n["f"])("h2",{class:"text-center text-success mt-5 mb-4"},[Object(n["g"])("Funds locked for you "),Object(n["f"])("i",{class:"text-secondary"},"(buyer)")],-1),ie={key:0,class:"text-center"},le=Object(n["f"])("i",{class:"text-primary"},"(No locked funds for you)",-1),de=[le],ce=Object(n["f"])("th",null,"Order ID",-1),ue=Object(n["f"])("th",null,"Timestamp",-1),be=Object(n["f"])("th",null,"Seller address",-1),me=Object(n["f"])("th",null,"Buyer address",-1),ye=Object(n["f"])("th",null,"Order Amount",-1);function fe(e,t,s,r,a,o){return o.loading?(Object(n["r"])(),Object(n["e"])("div",H,q)):a.error?(Object(n["r"])(),Object(n["e"])("div",V,[Object(n["f"])("h2",K,Object(n["y"])(a.error),1)])):(Object(n["r"])(),Object(n["e"])("div",Y,[Object(n["f"])("div",J,[W,0===a.sellerOrders.length?(Object(n["r"])(),Object(n["e"])("div",z,Q)):Object(n["d"])("",!0),(Object(n["r"])(!0),Object(n["e"])(n["a"],null,Object(n["v"])(a.sellerOrders,t=>(Object(n["r"])(),Object(n["e"])("table",{class:"text-left mt-4",style:{margin:"0 auto"},key:t.id},[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[X,Object(n["f"])("td",null,Object(n["y"])(t.id),1)]),Object(n["f"])("tr",null,[Z,Object(n["f"])("td",null,Object(n["y"])(e.formatTimestamp(t.timestamp)),1)]),Object(n["f"])("tr",null,[ee,Object(n["f"])("td",null,Object(n["y"])(t.sellerAddress.toLowerCase()),1)]),Object(n["f"])("tr",null,[te,Object(n["f"])("td",null,Object(n["y"])(t.buyerAddress.toLowerCase()),1)]),Object(n["f"])("tr",null,[se,Object(n["f"])("td",null,Object(n["y"])(e.formatOrderAmount(t)),1)]),Object(n["f"])("tr",null,[ne,Object(n["f"])("td",null,Object(n["y"])(e.formatOrderFeeAmount(t)),1)]),Object(n["f"])("tr",null,[re,Object(n["f"])("td",null,Object(n["y"])(e.formatOrderTotalAmount(t)),1)])])]))),128))]),Object(n["f"])("div",ae,[oe,0===a.buyerOrders.length?(Object(n["r"])(),Object(n["e"])("div",ie,de)):Object(n["d"])("",!0),(Object(n["r"])(!0),Object(n["e"])(n["a"],null,Object(n["v"])(a.buyerOrders,t=>(Object(n["r"])(),Object(n["e"])("table",{class:"text-left mt-4",style:{margin:"0 auto"},key:t.id},[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[ce,Object(n["f"])("td",null,Object(n["y"])(t.id),1)]),Object(n["f"])("tr",null,[ue,Object(n["f"])("td",null,Object(n["y"])(e.formatTimestamp(t.timestamp)),1)]),Object(n["f"])("tr",null,[be,Object(n["f"])("td",null,Object(n["y"])(t.sellerAddress.toLowerCase()),1)]),Object(n["f"])("tr",null,[me,Object(n["f"])("td",null,Object(n["y"])(t.buyerAddress.toLowerCase()),1)]),Object(n["f"])("tr",null,[ye,Object(n["f"])("td",null,Object(n["y"])(e.formatOrderAmount(t)),1)])])]))),128))])]))}var pe={components:{},created(){this.$store.commit("setActiveSection","HomePage"),this.loadOffers()},data(){return{sellerOrders:[],buyerOrders:[],error:null}},watch:{activeConnection(){this.loading||this.loadOffers()}},computed:{loading(){return this.$store.state.loading},activeConnection(){return this.$store.state.activeConnection}},methods:{async loadOffers(){this.$store.commit("setLoading",!0);try{let e=await B.getInstance(),t=await e.contract.methods.userOrders(e.walletAddress).call(),s=t.filter(e=>"1"===e.status);for(let n=0;n<s.length;n++)s[n]={...s[n]},s[n].token=this.getTokenByAddress(s[n].tokenContractAddress);this.sellerOrders=s.filter(t=>t.sellerAddress.toLowerCase()===e.walletAddress.toLowerCase()),this.buyerOrders=s.filter(t=>t.buyerAddress.toLowerCase()===e.walletAddress.toLowerCase()),this.$store.commit("setLoading",!1)}catch(e){this.error=e,this.$store.commit("setLoading",!1)}}}};const he=_()(pe,[["render",fe]]);var Oe=he;const je={key:0,class:"loading_container"},ge=Object(n["f"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["f"])("span",{class:"sr-only"})],-1),we=[ge],Ae={key:1,class:"loading_container"},ke={class:"text-danger"},ve={key:2,class:"loading_container"},Te=Object(n["f"])("h2",{class:"text-success mb-2"},"Escrow status",-1),Ce={class:"text-left",style:{margin:"0 auto"}},xe={class:"text-left mt-4",style:{margin:"0 auto"}},Ie=Object(n["f"])("th",null,"Order ID",-1),Se=Object(n["f"])("th",null,"Timestamp",-1),Be=Object(n["f"])("th",null,"Seller address",-1),Re=Object(n["f"])("th",null,"Buyer address",-1),Ee=Object(n["f"])("th",null,"Order amount",-1),_e={key:0},$e=Object(n["f"])("th",null,"Fee",-1),Le={key:1},Pe=Object(n["f"])("th",null,"Total",-1),Ne=Object(n["f"])("th",null,"Status",-1),Fe={key:0,class:"badge bg-warning"},De={key:1,class:"badge bg-success"},Me={key:2,class:"badge bg-danger"},He={key:0,class:"text-center mt-4"},Ue=Object(n["f"])("i",{class:"fa fa-plus"},null,-1);function qe(e,t,s,r,a,o){return o.loading?(Object(n["r"])(),Object(n["e"])("div",je,we)):a.error?(Object(n["r"])(),Object(n["e"])("div",Ae,[Object(n["f"])("h2",ke,Object(n["y"])(a.error),1)])):(Object(n["r"])(),Object(n["e"])("div",ve,[Te,Object(n["f"])("table",Ce,[Object(n["f"])("table",xe,[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[Ie,Object(n["f"])("td",null,Object(n["y"])(a.orderId),1)]),Object(n["f"])("tr",null,[Se,Object(n["f"])("td",null,Object(n["y"])(a.timestamp),1)]),Object(n["f"])("tr",null,[Be,Object(n["f"])("td",null,Object(n["y"])(a.sellerAddress),1)]),Object(n["f"])("tr",null,[Re,Object(n["f"])("td",null,Object(n["y"])(a.buyerAddress),1)]),Object(n["f"])("tr",null,[Ee,Object(n["f"])("td",null,Object(n["y"])(a.orderAmount),1)]),a.refunded?(Object(n["r"])(),Object(n["e"])("tr",_e,[$e,Object(n["f"])("td",null,Object(n["y"])(a.orderAmount),1)])):Object(n["d"])("",!0),a.refunded?(Object(n["r"])(),Object(n["e"])("tr",Le,[Pe,Object(n["f"])("td",null,Object(n["y"])(a.totalAmount),1)])):Object(n["d"])("",!0),Object(n["f"])("tr",null,[Ne,Object(n["f"])("td",null,[a.locked?(Object(n["r"])(),Object(n["e"])("span",Fe,"LOCKED")):a.released?(Object(n["r"])(),Object(n["e"])("span",De,Object(n["y"])(a.adminAction?"RELEASED TO BUYER BY ADMIN":"RELEASED TO BUYER"),1)):(Object(n["r"])(),Object(n["e"])("span",Me,Object(n["y"])(a.adminAction?"SELLER REFUNDED BY ADMIN":"SELLER REFUNDED"),1))])])])])]),"RBTC"!==a.token.id?(Object(n["r"])(),Object(n["e"])("div",He,[Object(n["f"])("button",{class:"btn btn-primary btn-block",onClick:t[0]||(t[0]=e=>o.addToken(a.token))},[Ue,Object(n["g"])(" Add "+Object(n["y"])(a.token.symbol)+" to your wallet",1)])])):Object(n["d"])("",!0)]))}const Ve=w.contractAddresses["production"],Ke=w.nodeURLs["production"];var Ye={components:{},created(){this.$store.commit("setActiveSection","RefundPage"),this.loadParams()},data(){return{orderId:null,token:null,timestamp:null,sellerAddress:null,buyerAddress:null,orderAmount:null,feeAmount:null,totalAmount:null,error:null,locked:!1,released:!1,refunded:!1,adminAction:!1}},computed:{loading(){return this.$store.state.loading}},methods:{async loadParams(){this.$store.commit("setLoading",!0);try{if(this.orderId=this.$route.query.orderId,this.isStringEmpty(this.orderId))throw"OrderID not specified. Please, verify your link.";let e=new j.a(Ke),t=new e.eth.Contract(w.rskEscrowABI,Ve),s=await t.methods.orderById(this.orderId).call();if(this.token=this.getTokenByAddress(s.tokenContractAddress),!this.token)throw"There was an error fetching details: token not supported.";if("0"===s.status)throw"Order not found. Please, verify your link.";if("1"===s.status)this.locked=!0;else if("2"===s.status)this.released=!0;else{if("3"!==s.status)throw"There was an error fetching details: order status not supported.";this.refunded=!0}this.timestamp=this.formatTimestamp(s.timestamp),this.buyerAddress=s.buyerAddress.toLowerCase(),this.sellerAddress=s.sellerAddress.toLowerCase(),this.orderAmount=this.formatOrderAmount(s),this.feeAmount=this.formatOrderFeeAmount(s),this.totalAmount=this.formatOrderTotalAmount(s),this.adminAction=s.adminAction,this.$store.commit("setLoading",!1)}catch(e){this.error=e,this.$store.commit("setLoading",!1)}},async addToken(e){let t={type:"ERC20",options:{...e}};window.ethereum.request({method:"wallet_watchAsset",params:t})}}};const Je=_()(Ye,[["render",qe]]);var We=Je;const ze={key:0,class:"loading_container"},Ge=Object(n["f"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["f"])("span",{class:"sr-only"})],-1),Qe=[Ge],Xe={key:1,class:"loading_container"},Ze={class:"text-danger"},et={key:2,class:"loading_container"},tt={class:"text-success mb-4"},st={class:"text-secondary"},nt={class:"text-dark fs-4"},rt={key:3,class:"loading_container"},at={class:"text-success mb-4"},ot={class:"text-secondary"},it=Object(n["f"])("p",{class:"text-primary"},"Your order will be automatically updated shortly. You can close this window.",-1),lt={key:4,class:"loading_container"},dt={class:"text-success mb-4"},ct={class:"text-secondary"},ut={class:"text-left",style:{margin:"0 auto"}},bt=Object(n["f"])("th",null,"Order ID",-1),mt=Object(n["f"])("th",null,"Buyer Address",-1),yt=Object(n["f"])("th",null,"Seller Address",-1),ft=Object(n["f"])("th",null,"Amount",-1),pt=Object(n["f"])("th",null,"Fee",-1),ht={class:"text-center mt-4"},Ot={key:0,class:"btn btn-primary btn-block",disabled:""};function jt(e,t,s,r,a,o){const i=Object(n["w"])("router-link");return o.loading?(Object(n["r"])(),Object(n["e"])("div",ze,Qe)):a.error?(Object(n["r"])(),Object(n["e"])("div",Xe,[Object(n["f"])("h2",Ze,Object(n["y"])(a.error),1)])):a.alreadyEscrowed?(Object(n["r"])(),Object(n["e"])("div",et,[Object(n["f"])("h2",tt,[Object(n["g"])("Funds already locked for order "),Object(n["f"])("i",st,Object(n["y"])(this.orderId),1)]),Object(n["f"])("p",nt,[Object(n["g"])("Click "),Object(n["h"])(i,{to:"/status?orderId="+a.orderId},{default:Object(n["B"])(()=>[Object(n["g"])("here")]),_:1},8,["to"]),Object(n["g"])(" to check the updated status.")])])):a.locked?(Object(n["r"])(),Object(n["e"])("div",rt,[Object(n["f"])("h2",at,[Object(n["g"])("Funds successfully locked for order "),Object(n["f"])("i",ot,Object(n["y"])(this.orderId),1)]),it])):(Object(n["r"])(),Object(n["e"])("div",lt,[Object(n["f"])("h2",dt,[Object(n["g"])("Lock funds for order "),Object(n["f"])("i",ct,Object(n["y"])(this.orderId),1)]),Object(n["f"])("table",ut,[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[bt,Object(n["f"])("td",null,Object(n["y"])(a.orderId),1)]),Object(n["f"])("tr",null,[mt,Object(n["f"])("td",null,Object(n["y"])(a.buyerAddress.toLowerCase()),1)]),Object(n["f"])("tr",null,[yt,Object(n["f"])("td",null,Object(n["y"])(a.sellerAddress.toLowerCase()),1)]),Object(n["f"])("tr",null,[ft,Object(n["f"])("td",null,Object(n["y"])(e.formatAmount(a.amount,a.token)),1)]),Object(n["f"])("tr",null,[pt,Object(n["f"])("td",null,Object(n["y"])(e.formatAmount(a.fee,a.token)),1)])])]),Object(n["f"])("div",ht,[a.locking?(Object(n["r"])(),Object(n["e"])("button",Ot,"Locking funds...")):(Object(n["r"])(),Object(n["e"])("button",{key:1,class:"btn btn-primary btn-block",onClick:t[0]||(t[0]=e=>o.lockFunds())},"Lock "+Object(n["y"])(e.formatAmount(a.totalAmount,a.token)),1))])]))}var gt={components:{},created(){this.$store.commit("setActiveSection","LockPage"),this.loadParams()},data(){return{orderId:null,buyerAddress:null,buyerHash:null,sellerAddress:null,sellerHash:null,token:null,amount:null,fee:null,totalAmount:null,error:null,locking:!1,locked:!1,alreadyEscrowed:!1}},watch:{activeConnection(){this.loading||this.loadParams()}},computed:{loading(){return this.$store.state.loading},activeConnection(){return this.$store.state.activeConnection}},methods:{async loadParams(){this.$store.commit("setLoading",!0);try{if(this.orderId=this.$route.query.orderId,this.buyerAddress=this.$route.query.buyerAddress,this.buyerHash=this.$route.query.buyerHash,this.sellerHash=this.$route.query.sellerHash,this.token=this.getToken(this.$route.query.token),this.amount=this.$route.query.amount,this.fee=this.$route.query.fee,this.isStringEmpty(this.orderId))throw"OrderID not specified. Please, verify your link.";if(this.isStringEmpty(this.buyerAddress)||!this.isValidAddress(this.buyerAddress))throw"BuyerAddress not specified. Please, verify your link.";if(this.isStringEmpty(this.buyerHash))throw"BuyerHash not specified. Please, verify your link.";if(this.isStringEmpty(this.sellerHash))throw"SellerHash not specified. Please, verify your link.";if(!this.token)throw"Invalid token specified. Please, verify your link.";if(this.isStringEmpty(this.amount)||!this.isValidAmount(this.amount,this.token.decimals,"1"))throw"Invalid amount. Please, verify your link.";if(this.isStringEmpty(this.fee)||!this.isValidAmount(this.fee,this.token.decimals,"0"))throw"Invalid fee. Please, verify your link.";let e=await B.getInstance(),t=await e.contract.methods.orderById(this.orderId).call();"0"!==t.status?this.alreadyEscrowed=!0:(this.buyerAddress=this.buyerAddress.toLowerCase(),this.sellerAddress=e.walletAddress.toLowerCase(),this.totalAmount=this.toBN(this.amount).add(this.toBN(this.fee))),this.$store.commit("setLoading",!1)}catch(e){this.error=e,this.$store.commit("setLoading",!1)}},async lockFunds(){this.locking=!0;try{let e=await B.getInstance(),t="0x"+this.buyerHash.toLowerCase(),s="0x"+this.sellerHash.toLowerCase();if("RBTC"===this.token.id){let n=[this.orderId,this.buyerAddress,t,s,this.amount,this.fee];await e.contract.methods.escrowRBTC(...n).send({from:e.walletAddress,value:this.totalAmount})}else{if("RIF"!==this.token.id&&"DOC"!==this.token.id)throw"Unsupported token: "+this.token.id;{let n=new e.web3Instance.eth.Contract(w.erc20ABI,this.token.address),r=await n.methods.allowance(e.walletAddress,e.contract._address).call({from:e.walletAddress}),a=await n.methods.balanceOf(e.walletAddress).call({from:e.walletAddress});if(this.toBN(a.toString()).lt(this.totalAmount))throw"Not enough "+this.token.symbol;this.toBN(r.toString()).lt(this.totalAmount)&&await n.methods.approve(e.contract._address,this.toBN(2).pow(this.toBN(255)).toString()).send({from:e.walletAddress});let o=[this.orderId,this.token.address,this.buyerAddress,t,s,this.amount,this.fee];await e.contract.methods.escrowERC20(...o).send({from:e.walletAddress})}}this.locked=!0,this.locking=!1}catch(e){this.locking=!1,this.showError(e)}}}};const wt=_()(gt,[["render",jt]]);var At=wt;const kt={key:0,class:"loading_container"},vt=Object(n["f"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["f"])("span",{class:"sr-only"})],-1),Tt=[vt],Ct={key:1,class:"loading_container"},xt={class:"text-danger"},It={key:2,class:"loading_container"},St=Object(n["f"])("h2",{class:"text-success mb-4"},"Release funds to buyer",-1),Bt={class:"text-left",style:{margin:"0 auto"}},Rt=Object(n["f"])("th",null,"Order ID",-1),Et=Object(n["f"])("th",null,"Timestamp",-1),_t=Object(n["f"])("th",null,"Buyer address",-1),$t=Object(n["f"])("th",null,"Amount",-1),Lt={class:"text-center mt-4"},Pt={key:0,class:"btn btn-primary btn-block",disabled:""},Nt={key:1,class:"btn btn-success btn-block",disabled:""},Ft={key:2,class:"btn btn-warning btn-block",disabled:""};function Dt(e,t,s,r,a,o){return o.loading?(Object(n["r"])(),Object(n["e"])("div",kt,Tt)):a.error?(Object(n["r"])(),Object(n["e"])("div",Ct,[Object(n["f"])("h2",xt,Object(n["y"])(a.error),1)])):(Object(n["r"])(),Object(n["e"])("div",It,[St,Object(n["f"])("table",Bt,[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[Rt,Object(n["f"])("td",null,Object(n["y"])(a.orderId),1)]),Object(n["f"])("tr",null,[Et,Object(n["f"])("td",null,Object(n["y"])(a.timestamp),1)]),Object(n["f"])("tr",null,[_t,Object(n["f"])("td",null,Object(n["y"])(a.buyerAddress),1)]),Object(n["f"])("tr",null,[$t,Object(n["f"])("td",null,Object(n["y"])(a.amount),1)])])]),Object(n["f"])("div",Lt,[a.releasing?(Object(n["r"])(),Object(n["e"])("button",Pt,"Releasing funds...")):a.released?(Object(n["r"])(),Object(n["e"])("button",Nt,"Funds already released to buyer")):a.refunded?(Object(n["r"])(),Object(n["e"])("button",Ft,"Seller has been refunded")):(Object(n["r"])(),Object(n["e"])("button",{key:3,class:"btn btn-primary btn-block",onClick:t[0]||(t[0]=e=>o.release())},"Release "+Object(n["y"])(a.amount),1))])]))}var Mt={name:"HomePage",components:{},created(){this.$store.commit("setActiveSection","ReleasePage"),this.loadParams()},data(){return{orderId:null,timestamp:null,buyerAddress:null,buyerCode:null,amount:null,error:null,releasing:!1,released:!1,refunded:!1}},watch:{activeConnection(){this.loading||this.loadParams()}},computed:{loading(){return this.$store.state.loading},activeConnection(){return this.$store.state.activeConnection}},methods:{async loadParams(){this.$store.commit("setLoading",!0);try{if(this.orderId=this.$route.query.orderId,this.buyerCode=this.$route.query.buyerCode,this.isStringEmpty(this.orderId))throw"OrderID not specified. Please, verify your link.";if(this.isStringEmpty(this.buyerCode))throw"BuyerCode not specified. Please, verify your link.";let e=await B.getInstance(),t=await e.contract.methods.orderById(this.orderId).call();if("0"===t.status)throw"Order not found. Please, verify your link.";if("2"===t.status)this.released=!0;else if("3"===t.status)this.refunded=!0;else if("1"!==t.status)throw"There was an error fetching details: order status not supported.";this.buyerAddress=t.buyerAddress,this.amount=this.formatOrderAmount(t),this.timestamp=this.formatTimestamp(t.timestamp),this.$store.commit("setLoading",!1)}catch(e){this.error=e,this.$store.commit("setLoading",!1)}},async release(){this.releasing=!0;try{let e=await B.getInstance(),t="0x"+this.buyerCode;await e.contract.methods.releaseToBuyer(this.orderId,t).send({from:e.walletAddress}),this.released=!0,this.releasing=!1,this.showSuccess("Funds released to buyer!")}catch(e){this.releasing=!1,this.showError(e)}}}};const Ht=_()(Mt,[["render",Dt]]);var Ut=Ht;const qt={key:0,class:"loading_container"},Vt=Object(n["f"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["f"])("span",{class:"sr-only"})],-1),Kt=[Vt],Yt={key:1,class:"loading_container"},Jt={class:"text-danger"},Wt={key:2,class:"loading_container"},zt=Object(n["f"])("h2",{class:"text-success mb-4"},"Refund seller",-1),Gt={class:"text-left",style:{margin:"0 auto"}},Qt=Object(n["f"])("th",null,"Order ID",-1),Xt=Object(n["f"])("th",null,"Timestamp",-1),Zt=Object(n["f"])("th",null,"Seller address",-1),es=Object(n["f"])("th",null,"Order amount",-1),ts=Object(n["f"])("th",null,"Fee",-1),ss=Object(n["f"])("th",null,"Total",-1),ns={class:"text-center mt-4"},rs={key:0,class:"btn btn-primary btn-block",disabled:""},as={key:1,class:"btn btn-warning btn-block",disabled:""},os={key:2,class:"btn btn-success btn-block",disabled:""};function is(e,t,s,r,a,o){return o.loading?(Object(n["r"])(),Object(n["e"])("div",qt,Kt)):a.error?(Object(n["r"])(),Object(n["e"])("div",Yt,[Object(n["f"])("h2",Jt,Object(n["y"])(a.error),1)])):(Object(n["r"])(),Object(n["e"])("div",Wt,[zt,Object(n["f"])("table",Gt,[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[Qt,Object(n["f"])("td",null,Object(n["y"])(a.orderId),1)]),Object(n["f"])("tr",null,[Xt,Object(n["f"])("td",null,Object(n["y"])(a.timestamp),1)]),Object(n["f"])("tr",null,[Zt,Object(n["f"])("td",null,Object(n["y"])(a.sellerAddress),1)]),Object(n["f"])("tr",null,[es,Object(n["f"])("td",null,Object(n["y"])(a.orderAmount),1)]),Object(n["f"])("tr",null,[ts,Object(n["f"])("td",null,Object(n["y"])(a.feeAmount),1)]),Object(n["f"])("tr",null,[ss,Object(n["f"])("td",null,Object(n["y"])(a.totalAmount),1)])])]),Object(n["f"])("div",ns,[a.refunding?(Object(n["r"])(),Object(n["e"])("button",rs,"Refunding seller...")):a.released?(Object(n["r"])(),Object(n["e"])("button",as,"Funds have been released to buyer")):a.refunded?(Object(n["r"])(),Object(n["e"])("button",os,"Seller already refunded")):(Object(n["r"])(),Object(n["e"])("button",{key:3,class:"btn btn-primary btn-block",onClick:t[0]||(t[0]=e=>o.refund())},"Refund "+Object(n["y"])(a.totalAmount),1))])]))}var ls={name:"HomePage",components:{},created(){this.$store.commit("setActiveSection","RefundPage"),this.loadParams()},data(){return{orderId:null,timestamp:null,sellerAddress:null,sellerCode:null,orderAmount:null,feeAmount:null,totalAmount:null,error:null,refunding:!1,released:!1,refunded:!1}},watch:{activeConnection(){this.loading||this.loadParams()}},computed:{loading(){return this.$store.state.loading},activeConnection(){return this.$store.state.activeConnection}},methods:{async loadParams(){this.$store.commit("setLoading",!0);try{if(this.orderId=this.$route.query.orderId,this.sellerCode=this.$route.query.sellerCode,this.isStringEmpty(this.orderId))throw"OrderID not specified. Please, verify your link.";if(this.isStringEmpty(this.sellerCode))throw"SellerCode not specified. Please, verify your link.";let e=await B.getInstance(),t=await e.contract.methods.orderById(this.orderId).call();if("0"===t.status)throw"Order not found. Please, verify your link.";if("2"===t.status)this.released=!0;else if("3"===t.status)this.refunded=!0;else if("1"!==t.status)throw"There was an error fetching details: order status not supported.";this.timestamp=this.formatTimestamp(t.timestamp),this.sellerAddress=t.sellerAddress.toLowerCase(),this.orderAmount=this.formatOrderAmount(t),this.feeAmount=this.formatOrderFeeAmount(t),this.totalAmount=this.formatOrderTotalAmount(t),this.$store.commit("setLoading",!1)}catch(e){this.error=e,this.$store.commit("setLoading",!1)}},async refund(){this.refunding=!0;try{let e=await B.getInstance(),t="0x"+this.sellerCode;await e.contract.methods.refundSeller(this.orderId,t).send({from:e.walletAddress}),this.refunded=!0,this.refunding=!1,this.showSuccess("Seller refunded!")}catch(e){this.refunding=!1,this.showError(e)}}}};const ds=_()(ls,[["render",is]]);var cs=ds;const us={key:0,class:"loading_container"},bs=Object(n["f"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["f"])("span",{class:"sr-only"})],-1),ms=[bs],ys={key:1,class:"loading_container"},fs={class:"text-danger"},ps={key:2,class:"loading_container"},hs=Object(n["f"])("h2",{class:"text-success mb-4"},"Release funds to buyer",-1),Os={class:"text-left",style:{margin:"0 auto"}},js=Object(n["f"])("th",null,"Order ID",-1),gs=Object(n["f"])("th",null,"Timestamp",-1),ws=Object(n["f"])("th",null,"Buyer address",-1),As=Object(n["f"])("th",null,"Amount",-1),ks={class:"text-center mt-4"},vs={key:0,class:"btn btn-primary btn-block",disabled:""},Ts={key:1,class:"btn btn-success btn-block",disabled:""},Cs={key:2,class:"btn btn-warning btn-block",disabled:""};function xs(e,t,s,r,a,o){return o.loading?(Object(n["r"])(),Object(n["e"])("div",us,ms)):a.error?(Object(n["r"])(),Object(n["e"])("div",ys,[Object(n["f"])("h2",fs,Object(n["y"])(a.error),1)])):(Object(n["r"])(),Object(n["e"])("div",ps,[hs,Object(n["f"])("table",Os,[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[js,Object(n["f"])("td",null,Object(n["y"])(a.orderId),1)]),Object(n["f"])("tr",null,[gs,Object(n["f"])("td",null,Object(n["y"])(a.timestamp),1)]),Object(n["f"])("tr",null,[ws,Object(n["f"])("td",null,Object(n["y"])(a.buyerAddress),1)]),Object(n["f"])("tr",null,[As,Object(n["f"])("td",null,Object(n["y"])(a.amount),1)])])]),Object(n["f"])("div",ks,[a.releasing?(Object(n["r"])(),Object(n["e"])("button",vs,"Releasing funds...")):a.released?(Object(n["r"])(),Object(n["e"])("button",Ts,"Funds already released to buyer")):a.refunded?(Object(n["r"])(),Object(n["e"])("button",Cs,"Seller has been refunded")):(Object(n["r"])(),Object(n["e"])("button",{key:3,class:"btn btn-primary btn-block",onClick:t[0]||(t[0]=e=>o.release())},"Release "+Object(n["y"])(a.amount),1))])]))}var Is={components:{},created(){this.$store.commit("setActiveSection","AdminReleasePage"),this.loadParams()},data(){return{orderId:null,timestamp:null,buyerAddress:null,amount:null,error:null,releasing:!1,released:!1,refunded:!1}},watch:{activeConnection(){this.loading||this.loadParams()}},computed:{loading(){return this.$store.state.loading},activeConnection(){return this.$store.state.activeConnection}},methods:{async loadParams(){this.$store.commit("setLoading",!0);try{if(this.orderId=this.$route.query.orderId,this.buyerCode=this.$route.query.buyerCode,this.isStringEmpty(this.orderId))throw"OrderID not specified. Please, verify your link.";let e=await B.getInstance(),t=await e.contract.methods.orderById(this.orderId).call();if("0"===t.status)throw"Order not found. Please, verify your link.";if("2"===t.status)this.released=!0;else if("3"===t.status)this.refunded=!0;else if("1"!==t.status)throw"There was an error fetching details: order status not supported.";this.buyerAddress=t.buyerAddress.toLowerCase(),this.amount=this.formatOrderAmount(t),this.timestamp=this.formatTimestamp(t.timestamp),this.$store.commit("setLoading",!1)}catch(e){this.error=e,this.$store.commit("setLoading",!1)}},async release(){this.releasing=!0;try{let e=await B.getInstance();await e.contract.methods.adminReleaseToBuyer(this.orderId).send({from:e.walletAddress}),this.released=!0,this.releasing=!1,this.showSuccess("Funds released to buyer!")}catch(e){this.releasing=!1,this.showError(e)}}}};const Ss=_()(Is,[["render",xs]]);var Bs=Ss;const Rs={key:0,class:"loading_container"},Es=Object(n["f"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["f"])("span",{class:"sr-only"})],-1),_s=[Es],$s={key:1,class:"loading_container"},Ls={class:"text-danger"},Ps={key:2,class:"loading_container"},Ns=Object(n["f"])("h2",{class:"text-success mb-4"},"Refund seller",-1),Fs={class:"text-left",style:{margin:"0 auto"}},Ds=Object(n["f"])("th",null,"Order ID",-1),Ms=Object(n["f"])("th",null,"Timestamp",-1),Hs=Object(n["f"])("th",null,"Seller address",-1),Us=Object(n["f"])("th",null,"Order amount",-1),qs=Object(n["f"])("th",null,"Fee",-1),Vs=Object(n["f"])("th",null,"Total",-1),Ks={class:"text-center mt-4"},Ys={key:0,class:"btn btn-primary btn-block",disabled:""},Js={key:1,class:"btn btn-warning btn-block",disabled:""},Ws={key:2,class:"btn btn-success btn-block",disabled:""};function zs(e,t,s,r,a,o){return o.loading?(Object(n["r"])(),Object(n["e"])("div",Rs,_s)):a.error?(Object(n["r"])(),Object(n["e"])("div",$s,[Object(n["f"])("h2",Ls,Object(n["y"])(a.error),1)])):(Object(n["r"])(),Object(n["e"])("div",Ps,[Ns,Object(n["f"])("table",Fs,[Object(n["f"])("tbody",null,[Object(n["f"])("tr",null,[Ds,Object(n["f"])("td",null,Object(n["y"])(a.orderId),1)]),Object(n["f"])("tr",null,[Ms,Object(n["f"])("td",null,Object(n["y"])(a.timestamp),1)]),Object(n["f"])("tr",null,[Hs,Object(n["f"])("td",null,Object(n["y"])(a.sellerAddress),1)]),Object(n["f"])("tr",null,[Us,Object(n["f"])("td",null,Object(n["y"])(a.orderAmount),1)]),Object(n["f"])("tr",null,[qs,Object(n["f"])("td",null,Object(n["y"])(a.feeAmount),1)]),Object(n["f"])("tr",null,[Vs,Object(n["f"])("td",null,Object(n["y"])(a.totalAmount),1)])])]),Object(n["f"])("div",Ks,[a.refunding?(Object(n["r"])(),Object(n["e"])("button",Ys,"Refunding seller...")):a.released?(Object(n["r"])(),Object(n["e"])("button",Js,"Funds have been released to buyer")):a.refunded?(Object(n["r"])(),Object(n["e"])("button",Ws,"Seller already refunded")):(Object(n["r"])(),Object(n["e"])("button",{key:3,class:"btn btn-primary btn-block",onClick:t[0]||(t[0]=e=>o.refund())},"Refund "+Object(n["y"])(a.totalAmount),1))])]))}var Gs={components:{},created(){this.$store.commit("setActiveSection","AdminRefundPage"),this.loadParams()},data(){return{orderId:null,timestamp:null,sellerAddress:null,orderAmount:null,feeAmount:null,totalAmount:null,error:null,refunding:!1,released:!1,refunded:!1}},watch:{activeConnection(){this.loading||this.loadParams()}},computed:{loading(){return this.$store.state.loading},activeConnection(){return this.$store.state.activeConnection}},methods:{async loadParams(){this.$store.commit("setLoading",!0);try{if(this.orderId=this.$route.query.orderId,this.isStringEmpty(this.orderId))throw"OrderID not specified. Please, verify your link.";let e=await B.getInstance(),t=await e.contract.methods.orderById(this.orderId).call();if("0"===t.status)throw"Order not found. Please, verify your link.";if("2"===t.status)this.released=!0;else if("3"===t.status)this.refunded=!0;else if("1"!==t.status)throw"There was an error fetching details: order status not supported.";this.timestamp=this.formatTimestamp(t.timestamp),this.sellerAddress=t.sellerAddress.toLowerCase(),this.orderAmount=this.formatOrderAmount(t),this.feeAmount=this.formatOrderFeeAmount(t),this.totalAmount=this.formatOrderTotalAmount(t),this.$store.commit("setLoading",!1)}catch(e){this.error=e,this.$store.commit("setLoading",!1)}},async refund(){this.refunding=!0;try{let e=await B.getInstance();await e.contract.methods.adminRefundSeller(this.orderId).send({from:e.walletAddress}),this.refunded=!0,this.refunding=!1,this.showSuccess("Seller refunded!")}catch(e){this.refunding=!1,this.showError(e)}}}};const Qs=_()(Gs,[["render",zs]]);var Xs=Qs;const Zs={class:"loading_container"},en=Object(n["f"])("h2",{class:"text-danger"},"Page not found",-1),tn=[en];function sn(e,t,s,r,a,o){return Object(n["r"])(),Object(n["e"])("div",Zs,tn)}var nn={created(){this.$store.commit("setActiveSection",""),this.$store.commit("setLoading",!1)},components:{},data(){return{}},methods:{}};const rn=_()(nn,[["render",sn]]);var an=rn;const on=[{path:"",component:Oe},{path:"/status",component:We},{path:"/lock",component:At},{path:"/release",component:Ut},{path:"/refund",component:cs},{path:"/adminRelease",component:Bs},{path:"/adminRefund",component:Xs},{path:"/rsk",component:Oe},{path:"/rsk/status",component:We},{path:"/rsk/lock",component:At},{path:"/rsk/release",component:Ut},{path:"/rsk/refund",component:cs},{path:"/rsk/adminRelease",component:Bs},{path:"/rsk/adminRefund",component:Xs},{path:"/:catchAll(.*)",component:an}];var ln=on,dn={isString(e){return"string"===typeof e||e instanceof String},isEmpty(e){return void 0===e||null===e||!this.isString(e)||0===e.trim().length},removeHexPrefix(e){return e.replace(/^0x/,"")},addHexPrefix(e){return"0x"+this.removeHexPrefix(e)}},cn=(s("d9e2"),s("5ba3")),un=s.n(cn),bn={isValidAmount(e,t,s,n){if(!dn.isString(e)||dn.isEmpty(e))return!1;const r="^(0|[1-9]\\d*)(\\.\\d{0,"+t+"})?$";if(!1===new RegExp(r).test(e))return!1;if(!dn.isEmpty(s))try{s=this.toBN(s)}catch(a){s=null}if(!dn.isEmpty(n))try{n=this.toBN(n)}catch(a){n=null}try{let t=this.toBN(e);if(s&&t.lt(s))throw"Value should be >= "+s.toString();if(n&&t.le(n))throw"Value should be <= "+n.toString()}catch(a){return!1}return!0},toBaseUnit(e,t){if(!dn.isString(e))throw new Error("Pass strings to prevent floating point precision issues.");const s="^(0|[1-9]\\d*)(\\.\\d{0,"+t+"})?$";if(!1===new RegExp(s).test(e))throw new Error("INVALID_NUMBER");const n=un.a.BN,r=new n(10),a=r.pow(new n(t));let o="-"===e.substring(0,1);if(o&&(e=e.substring(1)),"."===e)throw new Error(`Invalid value ${e} cannot be converted to base unit with ${t} decimals.`);let i=e.split(".");if(i.length>2)throw new Error("Too many decimal points");let l=i[0],d=i[1];if(l||(l="0"),d||(d="0"),d.length>t)throw new Error("Too many decimal places");while(d.length<t)d+="0";l=new n(l),d=new n(d);let c=l.mul(a).add(d);return o&&(c=c.neg()),new n(c.toString(10),10)},toBN(e){return new un.a.BN(e)},exp(e,t){return this.toBN(e).pow(this.toBN(t))},formatUnit(e,t){e=this.toBN(e);let s=new un.a.BN(10).pow(new un.a.BN(t)),n=e.mod(s).toString(10);while(n.length<t)n="0"+n;n=n.match(/^([0-9]*[1-9]|0)(0*)/)[1];let r=e.div(s).toString(10);e=`${r}.${n}`;let a=t-n.length;while(a>0)a--,e+="0";return e},toBigInt(e){return BigInt(e)}},mn={isValidAddress(e){return un.a.isAddress(e)}},yn={formatDuration(e){if(!e)return"-";let t=Number(e),s=Math.floor(t/86400),n=Math.floor(t%86400/3600),r=Math.floor(t%3600/60),a=Math.floor(t%60),o=s>0?s+(1==s?" day, ":" days, "):"",i=n>0?n+(1==n?" hour, ":" hours, "):"",l=r>0?r+(1==r?" minute, ":" minutes, "):"",d=a>0?a+(1==a?" second":" seconds"):"",c=o+i+l+d;return c.endsWith(", ")&&(c=c.substring(0,c.length-2)),c},formatTimestamp(e){return e?new Date(1e3*Number(e)).toLocaleString():"-"}};const fn=window["$"];function pn(e){let t={};for(let s in e)e.hasOwnProperty(s)&&(t[e[s].address]=e[s]);return t}let hn=pn(w.tokens["production"]);var On={methods:{isStringEmpty(e){return dn.isEmpty(e)},isValidAddress(e){return mn.isValidAddress(e)},isValidAmount(e,t,s){return bn.isValidAmount(e,t,s)},toBN(e){return new un.a.BN(e)},toBytes32(e){return un.a.fromAscii(e)},getToken(e){return e&&(e=String(e).toUpperCase()),w.tokens["production"][e]},getTokenByAddress(e){return hn[e.toLowerCase()]},formatAddress(e){return(e.substring(0,7)+"..."+e.substring(e.length-5)).toLowerCase()},formatTimestamp(e){return yn.formatTimestamp(e)},formatAmount(e,t){if(!e)return null;if(!t)return null;let s=bn.formatUnit(e.toString(),t.decimals)+" "+t.symbol;return s},formatOrderAmount(e){let t=this.formatAmount(this.toBN(e.amount),this.getTokenByAddress(e.tokenContractAddress));return t||null},formatOrderFeeAmount(e){let t=this.formatAmount(this.toBN(e.fee),this.getTokenByAddress(e.tokenContractAddress));return t||null},formatOrderTotalAmount(e){let t=this.toBN(e.fee).add(this.toBN(e.amount)),s=this.formatAmount(t,this.getTokenByAddress(e.tokenContractAddress));return s||null},showError(e){let t;console.log(e),t=e.data&&e.data.data&&e.data.data.message?e.data.data.message:e.message?e.message:e,this.$store.commit("setLoading",!1),fn("#errorMsg").text(t),fn("#errorModal").modal("show")},showSuccess(e){fn("#successMsg").text(e),fn("#successModal").modal("show")}}};if(localStorage)try{localStorage.removeItem("walletconnect")}catch(An){console.log(An)}const jn=Object(a["a"])(M),gn=Object(r["a"])({history:Object(r["b"])(),routes:ln}),wn=Object(n["c"])(L);wn.use(gn),wn.use(jn),wn.mixin(On),wn.mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){},a840:function(e){e.exports=JSON.parse('[{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transferFrom","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":true,"name":"owner","type":"address"},{"indexed":true,"name":"spender","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"address"},{"indexed":true,"name":"to","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Transfer","type":"event"}]')}});
//# sourceMappingURL=app.3fb7014f.js.map